{"ast":null,"code":"var _jsxFileName = \"/Users/abhinavprasad/Downloads/Moodify Application/src/App.js\",\n    _s = $RefreshSig$();\n\nimport { useRef, useEffect, useState } from 'react';\nimport './App.css';\nimport * as faceapi from \"face-api.js\";\nimport { FaceExpressions } from 'face-api.js'; // import express from 'express';\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction App() {\n  _s();\n\n  let number = 0;\n  const videoRef = useRef();\n  const canvasRef = useRef();\n  useEffect(() => {\n    startVideo();\n    videoRef && loadModels();\n  }, []);\n\n  const loadModels = () => {\n    Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri('/models'), faceapi.nets.faceLandmark68Net.loadFromUri('/models'), faceapi.nets.faceRecognitionNet.loadFromUri('/models'), faceapi.nets.faceExpressionNet.loadFromUri('/models')]).then(() => {\n      faceDetection();\n    });\n  };\n\n  const startVideo = () => {\n    navigator.mediaDevices.getUserMedia({\n      video: true\n    }).then(currentStream => {\n      videoRef.current.srcObject = currentStream;\n    }).catch(err => {\n      console.error(err);\n    });\n  };\n\n  const buttonclicked = () => {\n    console.log(\"button clicked\");\n  };\n\n  const faceDetection = async () => {\n    setInterval(async () => {\n      if (number == 1) {\n        return;\n      }\n\n      const detections = await faceapi.detectAllFaces(videoRef.current, new faceapi.TinyFaceDetectorOptions()).withFaceLandmarks().withFaceExpressions();\n      let emotions_displayed = detections[0].expressions;\n\n      if (emotions_displayed != undefined) {\n        number++;\n      }\n\n      let max_emotion = 0;\n      let final_emotion = \"\";\n\n      for (const [key, value] of Object.entries(emotions_displayed)) {\n        if (value > max_emotion) {\n          max_emotion = value;\n          final_emotion = key;\n        }\n      }\n\n      const options = {\n        method: 'GET',\n        headers: {\n          'X-RapidAPI-Key': 'fb5b0920f6msh804c07d430a8210p1d0067jsn6dc2b529beba',\n          'X-RapidAPI-Host': 'spotify23.p.rapidapi.com'\n        }\n      };\n      fetch('https://spotify23.p.rapidapi.com/search/?q=' + final_emotion + '&type=playlist&limit=5', options).then(response => response.json()).then(val => {\n        const selected_playlist = val.playlists.items[0].data['uri'];\n        const selected_playlist_id = selected_playlist.slice(17);\n        console.log(selected_playlist.slice(17));\n        const playlist_opened = 'https://open.spotify.com/playlist/' + selected_playlist_id; // console.log(typeof selected_playlist);\n\n        window.open(playlist_opened, '_blank');\n      }) // .then(response => console.log(response))\n      .catch(err => console.error(err));\n      canvasRef.current.innerHtml = faceapi.createCanvasFromMedia(videoRef.current);\n      faceapi.matchDimensions(canvasRef.current, {\n        width: 940,\n        height: 650\n      });\n      const resized = faceapi.resizeResults(detections, {\n        width: 940,\n        height: 650\n      });\n      faceapi.draw.drawDetections(canvasRef.current, resized);\n      faceapi.draw.drawFaceLandmarks(canvasRef.current, resized);\n      faceapi.draw.drawFaceExpressions(canvasRef.current, resized);\n    }, 30000);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \" AI FACE DETECTION\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"  \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"app__video\",\n      children: /*#__PURE__*/_jsxDEV(\"video\", {\n        crossOrigin: \"anonymous\",\n        ref: videoRef,\n        autoPlay: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      width: \"940\",\n      height: \"650\",\n      className: \"app__canvas\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"button\",\n      onClick: buttonclicked,\n      children: \" Click me! \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 111,\n    columnNumber: 5\n  }, this);\n}\n\n_s(App, \"0gwqVvoOV2or9Ql4L8GH2BGn3hc=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["useRef","useEffect","useState","faceapi","FaceExpressions","App","number","videoRef","canvasRef","startVideo","loadModels","Promise","all","nets","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceRecognitionNet","faceExpressionNet","then","faceDetection","navigator","mediaDevices","getUserMedia","video","currentStream","current","srcObject","catch","err","console","error","buttonclicked","log","setInterval","detections","detectAllFaces","TinyFaceDetectorOptions","withFaceLandmarks","withFaceExpressions","emotions_displayed","expressions","undefined","max_emotion","final_emotion","key","value","Object","entries","options","method","headers","fetch","response","json","val","selected_playlist","playlists","items","data","selected_playlist_id","slice","playlist_opened","window","open","innerHtml","createCanvasFromMedia","matchDimensions","width","height","resized","resizeResults","draw","drawDetections","drawFaceLandmarks","drawFaceExpressions"],"sources":["/Users/abhinavprasad/Downloads/Moodify Application/src/App.js"],"sourcesContent":["import { useRef, useEffect, useState } from 'react';\nimport './App.css';\nimport * as faceapi from \"face-api.js\";\nimport { FaceExpressions } from 'face-api.js';\n// import express from 'express';\n\nfunction App() {\n\n  let number = 0;\n\n  const videoRef = useRef();\n  const canvasRef = useRef();\n\n  useEffect(() => {\n    startVideo();\n\n    videoRef && loadModels();\n\n  }, []);\n  \n    const loadModels = () => {\n      Promise.all([\n        faceapi.nets.tinyFaceDetector.loadFromUri('/models'),\n        faceapi.nets.faceLandmark68Net.loadFromUri('/models'),\n        faceapi.nets.faceRecognitionNet.loadFromUri('/models'),\n        faceapi.nets.faceExpressionNet.loadFromUri('/models'),\n      ]).then(() => {\n        faceDetection();\n      })\n    };\n  \n  const startVideo = () => {\n    navigator.mediaDevices.getUserMedia({ video: true })\n      .then((currentStream) => {\n        videoRef.current.srcObject = currentStream;\n      })\n      .catch((err) => {\n        console.error(err)\n      });\n  }\n\n  const buttonclicked = () => {\n    console.log(\"button clicked\")\n  }\n  \n  const faceDetection = async () => {\n    setInterval(async() => {\n      if (number==1)\n      {\n        return\n      }\n      \n      const detections = await faceapi.detectAllFaces(videoRef.current, new faceapi.TinyFaceDetectorOptions()).withFaceLandmarks().withFaceExpressions();\n      let emotions_displayed = detections[0].expressions;\n      if (emotions_displayed != undefined)\n      {\n        number++;\n        \n      }\n      let max_emotion = 0\n      let final_emotion = \"\"\n      for (const [key,value] of Object.entries(emotions_displayed))\n      {\n        if (value > max_emotion)\n        {\n          max_emotion = value\n          final_emotion = key\n        }\n      }\n\n      const options = {\n        method: 'GET',\n        headers: {\n          'X-RapidAPI-Key': 'fb5b0920f6msh804c07d430a8210p1d0067jsn6dc2b529beba',\n          'X-RapidAPI-Host': 'spotify23.p.rapidapi.com'\n        }\n      };\n      \n      fetch('https://spotify23.p.rapidapi.com/search/?q=' + final_emotion + '&type=playlist&limit=5', options)\n        .then(response => response.json())\n        .then( (val) => {\n          const selected_playlist = val.playlists.items[0].data['uri'];\n          const selected_playlist_id = selected_playlist.slice(17);\n          console.log(selected_playlist.slice(17));\n          const playlist_opened = 'https://open.spotify.com/playlist/' + selected_playlist_id;\n          // console.log(typeof selected_playlist);\n          window.open(playlist_opened,'_blank');\n        } )\n        // .then(response => console.log(response))\n        .catch(err => console.error(err));\n  \n      canvasRef.current.innerHtml = faceapi.createCanvasFromMedia(videoRef.current);\n      faceapi.matchDimensions(canvasRef.current, {\n        width: 940,\n        height: 650,\n      })\n\n      const resized = faceapi.resizeResults(detections, {\n        width: 940,\n        height: 650,\n      });\n\n      faceapi.draw.drawDetections(canvasRef.current, resized)\n      faceapi.draw.drawFaceLandmarks(canvasRef.current, resized)\n      faceapi.draw.drawFaceExpressions(canvasRef.current, resized)\n\n    }, 30000)\n  }\n\n  return (\n    <div  className=\"app\">\n      <h1> AI FACE DETECTION</h1>\n      <h1>  </h1>\n      <div className='app__video'>\n        <video crossOrigin='anonymous' ref={videoRef} autoPlay ></video>\n      </div>\n        <canvas ref={canvasRef} width=\"940\" height=\"650\" className='app__canvas' />\n        <button type='button' onClick={buttonclicked}> Click me! </button>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}